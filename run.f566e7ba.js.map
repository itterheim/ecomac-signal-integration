{"version":3,"sources":["ts/Chart.ts","ts/Data.ts","ts/Table.ts","ts/App.ts","ts/run.ts"],"names":[],"mappings":"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","file":"run.f566e7ba.js","sourceRoot":"..","sourcesContent":["import { IData } from './interfaces/IData';\r\nimport { IMark } from './interfaces/IMark';\r\nimport { IValue } from './interfaces/IValue';\r\n\r\ntype Tool = 'start' | 'end' | 'move';\r\n\r\nexport class Chart {\r\n    public onMarksUpdated: (marks: IMark[]) => void;\r\n\r\n    private ctx: CanvasRenderingContext2D;\r\n    private tool: Tool = 'start';\r\n\r\n    private data?: IData;\r\n    private marks: IMark[] = [];\r\n\r\n    private minTime: number;\r\n    private maxTime: number;\r\n    private timeRange: number;\r\n\r\n    private min: IValue;\r\n    private max: IValue;\r\n    private range: number;\r\n\r\n    private padding = { t: 40, r: 40, b: 50, l: 100};\r\n    private scale = 1;\r\n    private offset = this.padding.l;\r\n\r\n    private selectionTime: number;\r\n    private selectionIndex: number;\r\n\r\n    constructor (private canvas: HTMLCanvasElement) {\r\n        this.canvas.className = `tool-${this.tool}`;\r\n        this.ctx = this.canvas.getContext('2d');\r\n\r\n        let mouseStart: { x: number, y: number };\r\n\r\n        this.canvas.onwheel = (e) => {\r\n            if (!this.data) { return; }\r\n\r\n            e.preventDefault();\r\n\r\n            const width = this.scale * this.canvas.width;\r\n\r\n            const scaleChange = -1 * e.deltaY / 100;\r\n            this.scale = Math.max(1, this.scale + scaleChange);\r\n\r\n            const mouse = this.getMousePosition(e);\r\n            const newWidth = this.scale * this.canvas.width;\r\n            const r = (-1 * this.offset + mouse.x) / width;\r\n\r\n            this.offset = -1 * (r * newWidth - mouse.x);\r\n            this.offset = Math.min(this.offset, this.canvas.width / 2);\r\n            this.offset = Math.max(this.offset, (-1 * this.scale * this.canvas.width) + this.canvas.width / 2);\r\n\r\n            this.render();\r\n        };\r\n\r\n        this.canvas.onmousedown = (e) => {\r\n            if (!this.data) { return; }\r\n\r\n            if (this.tool === 'move' || e.ctrlKey) {\r\n                mouseStart = this.getMousePosition(e);\r\n            } else if (this.selectionIndex !== undefined) {\r\n                const value = this.data.values[this.selectionIndex];\r\n                const type = this.tool === 'start' ? 'start' : 'end';\r\n\r\n                const markIndex = this.marks.findIndex((x) => x.index === this.selectionIndex && x.type === type);\r\n\r\n                if (markIndex > -1) {\r\n                    this.marks.splice(markIndex, 1);\r\n                } else {\r\n                    this.marks.push({\r\n                        type,\r\n                        index: this.selectionIndex,\r\n                        ...value\r\n                    });\r\n                }\r\n\r\n                this.marks.sort((a, b) => {\r\n                    if (a.index > b.index) {\r\n                        return 1;\r\n                    } else if (a.index === b.index && a.type === 'end') {\r\n                        return -1;\r\n                    } else if (a.index === b.index && a.type === 'start') {\r\n                        return 1;\r\n                    } else {\r\n                        return -1;\r\n                    }\r\n                });\r\n\r\n                this.render();\r\n                if (this.onMarksUpdated) { this.onMarksUpdated(this.marks); }\r\n            }\r\n        };\r\n\r\n        this.canvas.onmouseup = () => {\r\n            mouseStart = undefined;\r\n        };\r\n\r\n        this.canvas.onmouseout = () => {\r\n            mouseStart = undefined;\r\n        };\r\n\r\n        this.canvas.onmousemove = (e) => {\r\n            if (!this.data) { return; }\r\n\r\n            if (mouseStart) {\r\n                const position = this.getMousePosition(e);\r\n\r\n                this.offset += position.x - mouseStart.x;\r\n                this.offset = Math.min(this.offset, this.canvas.width / 2);\r\n                this.offset = Math.max(this.offset, (-1 * this.scale * this.canvas.width) + this.canvas.width / 2);\r\n\r\n                mouseStart = position;\r\n                this.render();\r\n            } else {\r\n                const mouse = this.getMousePosition(e);\r\n                const px = -1 * this.offset + mouse.x;\r\n                const width = this.scale * (this.canvas.width - this.padding.l - this.padding.r);\r\n                const r = px / width;\r\n\r\n                if (this.timeRange) {\r\n                    this.selectionTime = this.minTime + this.timeRange * r;\r\n                    this.selectionIndex = undefined;\r\n                    for (let i = 0; i < this.data.values.length && this.data.values[i].time < this.selectionTime; i++) {\r\n                        this.selectionIndex = i;\r\n                    }\r\n                }\r\n\r\n                this.render();\r\n            }\r\n        };\r\n\r\n        document.onkeyup = (e) => {\r\n            if (e.code === 'KeyS') { this.tool = 'start'; }\r\n            if (e.code === 'KeyE') { this.tool = 'end'; }\r\n            if (e.code === 'KeyM') { this.tool = 'move'; }\r\n\r\n            this.canvas.style.cursor = '';\r\n\r\n            this.render();\r\n        };\r\n\r\n        document.onkeydown = (e) => {\r\n            if (e.ctrlKey) {\r\n                this.canvas.style.cursor = 'move';\r\n            // } else {\r\n            //     this.canvas.style.cursor = undefined;\r\n            }\r\n        };\r\n    }\r\n\r\n    public setData (data: IData) {\r\n        this.data = data;\r\n        this.marks = [];\r\n\r\n        this.scale = 1;\r\n        this.offset = this.padding.l;\r\n        this.selectionTime = undefined;\r\n        this.selectionIndex = undefined;\r\n\r\n        this.minTime = this.data.values[0].time;\r\n        this.maxTime = this.data.values[this.data.values.length - 1].time;\r\n        this.timeRange = this.maxTime - this.minTime;\r\n\r\n        this.adjustMinMax();\r\n        this.render();\r\n    }\r\n\r\n    public setTool (tool: Tool) {\r\n        this.tool = tool;\r\n        this.canvas.className = `tool-${this.tool}`;\r\n        this.selectionIndex = undefined;\r\n        this.selectionTime = undefined;\r\n    }\r\n\r\n    public render () {\r\n        this.clear();\r\n\r\n        this.adjustMinMax();\r\n\r\n        if (this.data) {\r\n            this.renderData();\r\n            this.renderAxis();\r\n        }\r\n    }\r\n\r\n    private adjustMinMax () {\r\n        if (!this.data) { return; }\r\n\r\n        const width = this.scale * (this.canvas.width - this.padding.l - this.padding.r);\r\n        const widthRatio = width / this.timeRange;\r\n        const visibleData = this.data.values.filter((value) => {\r\n            const x = this.offset + (value.time - this.minTime) * widthRatio;\r\n            return x > 0 && x < this.canvas.width;\r\n        });\r\n\r\n        this.min = undefined;\r\n        this.max = undefined;\r\n        this.range = undefined;\r\n        for (const value of visibleData) {\r\n            if (!this.min || this.min.signal > value.signal) { this.min = value; }\r\n            if (!this.max || this.max.signal < value.signal) { this.max = value; }\r\n        }\r\n        this.range = this.max.signal - this.min.signal;\r\n    }\r\n\r\n    private renderData () {\r\n        const width = this.scale * (this.canvas.width - this.padding.l - this.padding.r);\r\n        const height = this.canvas.height - this.padding.b - this.padding.t;\r\n        const widthRatio = width / this.timeRange;\r\n        const heightRatio = height / this.range;\r\n\r\n        this.ctx.strokeStyle = '#000';\r\n        this.ctx.lineWidth = 0.8;\r\n        this.ctx.beginPath();\r\n\r\n        let time: number;\r\n        let selectedX: number;\r\n        let selectedY: number;\r\n        for (let i = 0; i < this.data.values.length; i++) {\r\n            const value = this.data.values[i];\r\n            const x = this.offset + (value.time - this.minTime) * widthRatio;\r\n            const y = this.padding.t + height - ((value.signal - this.min.signal) * heightRatio);\r\n\r\n            if (x > 0) {\r\n                if (time) {\r\n                    this.ctx.lineTo(x, y);\r\n                } else {\r\n                    this.ctx.moveTo(x, y);\r\n                }\r\n                time = value.time;\r\n\r\n                if (i === this.selectionIndex) {\r\n                    selectedX = x;\r\n                    selectedY = y;\r\n                }\r\n            }\r\n\r\n        }\r\n        this.ctx.stroke();\r\n\r\n        if (this.tool !== 'move') {\r\n            this.ctx.lineWidth = 1.2;\r\n            this.ctx.beginPath();\r\n            this.ctx.moveTo(selectedX, selectedY);\r\n            if (this.tool === 'start') {\r\n                this.ctx.lineTo(selectedX, selectedY + 15);\r\n                this.ctx.strokeStyle = '#0b0';\r\n            } else if (this.tool === 'end') {\r\n                this.ctx.lineTo(selectedX, selectedY + 15);\r\n                this.ctx.strokeStyle = '#d00';\r\n            }\r\n            this.ctx.stroke();\r\n        }\r\n\r\n        for (const mark of this.marks) {\r\n            const x = this.offset + (mark.time - this.minTime) * widthRatio;\r\n            const y = this.padding.t + height - ((mark.signal - this.min.signal) * heightRatio);\r\n\r\n            this.ctx.lineCap = 'round';\r\n            this.ctx.lineWidth = 1;\r\n            if (mark.type === 'start') {\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = '#0b0';\r\n                this.ctx.fillStyle = '#0b0';\r\n\r\n                this.ctx.moveTo(x, y);\r\n                this.ctx.lineTo(x, y + 5);\r\n                this.ctx.lineTo(x + 5, y + 10);\r\n                this.ctx.lineTo(x, y + 15);\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n                this.ctx.stroke();\r\n            } else if (mark.type === 'end') {\r\n                this.ctx.beginPath();\r\n                this.ctx.strokeStyle = '#d00';\r\n                this.ctx.fillStyle = '#d00';\r\n\r\n                this.ctx.moveTo(x, y);\r\n                this.ctx.lineTo(x, y + 5);\r\n                this.ctx.lineTo(x - 5, y + 10);\r\n                this.ctx.lineTo(x, y + 15);\r\n                this.ctx.closePath();\r\n                this.ctx.fill();\r\n                this.ctx.stroke();\r\n            }\r\n        }\r\n\r\n        let lineStart: IPoint;\r\n        for (let i = 0; i < this.marks.length; i++) {\r\n            const mark = this.marks[i];\r\n            const x = this.offset + (mark.time - this.minTime) * widthRatio;\r\n            const y = this.padding.t + height - ((mark.signal - this.min.signal) * heightRatio);\r\n\r\n            if (mark.type === 'start' && !lineStart) {\r\n                lineStart = {x, y};\r\n            } else if (mark.type === 'end' && lineStart) {\r\n                this.ctx.lineWidth = 1;\r\n                this.ctx.strokeStyle = '#777';\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(lineStart.x, lineStart.y);\r\n                this.ctx.lineTo(x, y);\r\n                this.ctx.stroke();\r\n\r\n                lineStart = undefined;\r\n            }\r\n        }\r\n\r\n        this.ctx.fillStyle = 'rgba(255,255,255,0.9)';\r\n        this.ctx.fillRect(0, 0, this.padding.l, this.canvas.height);\r\n    }\r\n\r\n    private renderAxis () {\r\n        const width = this.scale * (this.canvas.width - this.padding.l - this.padding.r);\r\n        const height = this.canvas.height - this.padding.b - this.padding.t;\r\n        const widthRatio = width / this.timeRange;\r\n        const heightRatio = height / this.range;\r\n\r\n        this.ctx.font = '12px sans-serif';\r\n        this.ctx.fillStyle = '#000';\r\n        this.ctx.strokeStyle = '#777';\r\n        this.ctx.lineWidth = 1;\r\n\r\n        // main lines\r\n        this.ctx.beginPath();\r\n        this.ctx.moveTo(this.padding.l - 0.5, this.padding.t);\r\n        this.ctx.lineTo(this.padding.l - 0.5, this.canvas.height - this.padding.b + 0.5);\r\n        this.ctx.lineTo(this.canvas.width - this.padding.r, this.canvas.height - this.padding.b + 0.5);\r\n        this.ctx.stroke();\r\n\r\n        // axis labels\r\n        this.ctx.textAlign = 'right';\r\n        this.ctx.textBaseline = 'bottom';\r\n        this.ctx.fillText(this.data.headers.signal.trim(), this.padding.l, this.padding.t - 5);\r\n\r\n        this.ctx.textAlign = 'right';\r\n        this.ctx.textBaseline = 'top';\r\n        this.ctx.fillText(this.data.headers.time.trim(), this.canvas.width - this.padding.r, this.canvas.height - this.padding.b + 25);\r\n\r\n        // time labels\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'top';\r\n\r\n        for (let m = 0; m < this.maxTime; m++) {\r\n            let x = this.offset + (m - this.minTime) * widthRatio;\r\n\r\n            if (x >= this.padding.l && x <= this.canvas.width - this.padding.r) {\r\n                x = Math.floor(x) + 0.5;\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(x, this.canvas.height - this.padding.b);\r\n                this.ctx.lineTo(x, this.canvas.height - this.padding.b + 5);\r\n                this.ctx.stroke();\r\n                this.ctx.fillText(m.toString(), x, this.canvas.height - this.padding.b + 10);\r\n            }\r\n        }\r\n\r\n        // signal labels\r\n        this.ctx.textAlign = 'right';\r\n        this.ctx.textBaseline = 'middle';\r\n\r\n        let prevY = -20;\r\n\r\n        const minSignal = Math.floor(this.min.signal);\r\n        for (let s = minSignal; s < this.max.signal; s += 0.5) {\r\n            let y = this.padding.t + height - ((s - this.min.signal) * heightRatio);\r\n\r\n            if (y <= this.canvas.height - this.padding.b && Math.abs(prevY - y) >= 20) {\r\n                y = Math.floor(y) + 0.5;\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(this.padding.l, y);\r\n                this.ctx.lineTo(this.padding.l - 5, y);\r\n                this.ctx.stroke();\r\n                this.ctx.fillText(s.toFixed(1), this.padding.l - 10, y);\r\n                prevY = y;\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    private clear () {\r\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n    }\r\n\r\n    private getMousePosition (e: MouseEvent): { x: number, y: number } {\r\n        const rect = this.canvas.getBoundingClientRect();\r\n        return {\r\n            x: e.clientX - rect.left,\r\n            y: e.clientY - rect.top\r\n        };\r\n    }\r\n}\r\n","import { IData } from './interfaces/IData';\r\nimport { IMark } from './interfaces/IMark';\r\nimport { IPeak } from './interfaces/IPeak';\r\nimport { IValue } from './interfaces/IValue';\r\n\r\nexport class Data implements IData {\r\n    public headers: { time: string, signal: string };\r\n    public values: IValue[] = [];\r\n\r\n    public marks: IMark[];\r\n    public peaks: IPeak[];\r\n\r\n    private maxSignal: number;\r\n    private minSignal: number;\r\n\r\n    constructor (public name: string, text: string) {\r\n        this.parseData(text);\r\n\r\n        const signals = this.values.map((x) => x.signal);\r\n        this.maxSignal = Math.max.apply(null, signals);\r\n        this.minSignal = Math.min.apply(null, signals);\r\n    }\r\n\r\n    public addMark (mark: IMark) {\r\n        this.marks.push(mark);\r\n        this.updatePeaks();\r\n    }\r\n\r\n    public removeMark (mark: IMark) {\r\n        this.marks = this.marks.filter((x) => x.index !== mark.index || x.type !== mark.type);\r\n        this.updatePeaks();\r\n    }\r\n\r\n    private updatePeaks () {\r\n        let lastMarks: IMark[] = [];\r\n        for (let i = 0; i < this.marks.length; i++) {\r\n            const mark = this.marks[i];\r\n\r\n            if (mark.type === 'start') {\r\n                lastMarks.push(mark);\r\n            } else if (mark.type === 'end' && lastMarks.length > 0) {\r\n\r\n                for (let j = 0; j < lastMarks.length; j++) {\r\n                    this.peaks.push({\r\n                        start: lastMarks[j].time,\r\n                        end: lastMarks[j + 1] && lastMarks[j + 1].type === 'start' ? lastMarks[j + 1].time : mark.time,\r\n                        previous: j > 0 ? lastMarks[0] : undefined,\r\n                        next: lastMarks[j + 1] && lastMarks[j + 1].type === 'start' ? mark : undefined,\r\n                        values: this.getValues(lastMarks[j], lastMarks[j + 1] && lastMarks[j + 1].type === 'start' ? lastMarks[j + 1] : mark),\r\n                        response: 0,\r\n                        retention: undefined\r\n                    });\r\n                }\r\n\r\n                lastMarks = [];\r\n            }\r\n        }\r\n\r\n        for (const peak of this.peaks) {\r\n            peak.response = this.getResponse(\r\n                peak.values,\r\n                this.values[peak.previous ? peak.previous.index : undefined],\r\n                this.values[peak.next ? peak.next.index : undefined]\r\n            );\r\n\r\n            peak.retention = peak.values.reduce((p, x) => !p || x.signal > p.signal ? x : p, undefined);\r\n        }\r\n    }\r\n\r\n    private getValues (from: IMark, to: IMark): IValue[] {\r\n        return this.values.slice(from.index, to.index + 1);\r\n    }\r\n\r\n    private getResponse (values: IValue[], previous?: IValue, next?: IValue): number {\r\n        const baseFrom: IValue = previous ? { time: previous.time, signal: previous.signal } : { time: values[0].time, signal: values[0].signal };\r\n        const baseTo: IValue = next ? { time: next.time, signal: next.signal } : { time: values[values.length - 1].time, signal: values[values.length - 1].signal };\r\n\r\n        let totalArea = 0;\r\n\r\n        for (let i = 0; i < values.length - 1; i++) {\r\n            const h = values[i + 1].time - values[i].time;\r\n\r\n            const intLeft = this.getIntersection(\r\n                baseFrom, baseTo,\r\n                // values[i],\r\n                { time: values[i].time, signal: this.maxSignal },\r\n                { time: values[i].time, signal: this.minSignal }\r\n            );\r\n\r\n            const intRight = this.getIntersection(\r\n                baseFrom, baseTo,\r\n                // values[i + 1],\r\n                { time: values[i + 1].time, signal: this.maxSignal },\r\n                { time: values[i + 1].time, signal: this.minSignal }\r\n            );\r\n\r\n            const a = values[i].signal - intLeft.signal;\r\n            const b = values[i + 1].signal - intRight.signal;\r\n\r\n            const area = ((a + b) / 2) * h;\r\n            totalArea += Math.abs(area);\r\n        }\r\n\r\n        return totalArea;\r\n    }\r\n\r\n    private getIntersection (l1From: IValue, l1To: IValue, l2From: IValue, l2To: IValue): IValue {\r\n        const p0x = l1From.time;\r\n        const p0y = l1From.signal;\r\n        const p1x = l1To.time;\r\n        const p1y = l1To.signal;\r\n        const p2x = l2From.time;\r\n        const p2y = l2From.signal;\r\n        const p3x = l2To.time;\r\n        const p3y = l2To.signal;\r\n\r\n        const s1x = p1x - p0x;\r\n        const s1y = p1y - p0y;\r\n        const s2x = p3x - p2x;\r\n        const s2y = p3y - p2y;\r\n\r\n        let ix: number;\r\n        let iy: number;\r\n\r\n        const s = (-s1y * (p0x - p2x) + s1x * (p0y - p2y)) / (-s2x * s1y + s1x * s2y);\r\n        const t = (s2x * (p0y - p2y) - s2y * (p0x - p2x)) / (-s2x * s1y + s1x * s2y);\r\n\r\n        if (s >= 0 && s <= 1 && t >= 0 && t <= 1) {\r\n            ix = p0x + (t * s1x);\r\n            iy = p0y + (t * s1y);\r\n            return { time: ix, signal: iy };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    private parseData (text: string) {\r\n        const rows = text.split('\\n');\r\n        let index = 0;\r\n\r\n        while (!rows[index].includes('# data plots')) { index++; }\r\n        index++;\r\n\r\n        const headers = rows[index].split(';');\r\n        this.headers = { time: headers[0].trim(), signal: headers[1].trim() };\r\n\r\n        index++;\r\n        while (!rows[index].includes('#')) {\r\n            this.values.push(this.parseValues(rows[index]));\r\n            index++;\r\n        }\r\n    }\r\n\r\n    private parseValues (text: string): IValue {\r\n        // 0,008750863969;215,747600000000\r\n\r\n        const texts = text.replace(/,/g, '.').split(';');\r\n\r\n        const value = {\r\n            time: parseFloat(texts[0]),\r\n            signal: parseFloat(texts[1])\r\n        };\r\n\r\n        return value;\r\n    }\r\n}\r\n","import { IMark } from './interfaces/IMark';\r\nimport { IPeak } from './interfaces/IPeak';\r\nimport { IValue } from './interfaces/IValue';\r\n\r\nexport class Table {\r\n    private marks: IMark[] = [];\r\n    private values: IValue[] = [];\r\n    private peaks: IPeak[] = [];\r\n\r\n    private maxSignal: number = 0;\r\n    private minSignal: number = 0;\r\n\r\n    private readonly decimals = 6;\r\n\r\n    constructor (private target: HTMLDivElement) {\r\n        this.update();\r\n    }\r\n\r\n    public update (marks: IMark[] = [], values: IValue[] = []) {\r\n        this.marks = marks;\r\n        this.values = values;\r\n\r\n        const signals = values.map((x) => x.signal);\r\n        this.maxSignal = Math.max.apply(null, signals);\r\n        this.minSignal = Math.min.apply(null, signals);\r\n\r\n        this.target.innerHTML = '';\r\n\r\n        this.peaks = this.getPeaks();\r\n\r\n        let rows = '';\r\n        for (let i = 0; i < this.peaks.length; i++) {\r\n            const peak = this.peaks[i];\r\n            rows += `\r\n            <tr>\r\n                <td>${i + 1}</td>\r\n                <td>${peak.start.toFixed(this.decimals)}</td>\r\n                <td>${peak.end.toFixed(this.decimals)}</td>\r\n                <td>${(peak.retention.time - peak.start).toFixed(this.decimals)}</td>\r\n                <td>${peak.retention.signal.toFixed(this.decimals)}</td>\r\n                <td>${(peak.response * 60).toFixed(this.decimals)}</td>\r\n            </tr>`;\r\n        }\r\n\r\n        const template = `\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        <th class=\"number\"></th>\r\n                        <th>Start [min]</th>\r\n                        <th>End [min]</th>\r\n                        <th>Reten. Time [min]</th>\r\n                        <th>Max. Signal [mV]</th>\r\n                        <th>Response [mV.s]</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    ${rows}\r\n                </tbody>\r\n            </table>\r\n        `;\r\n\r\n        this.target.innerHTML = template;\r\n    }\r\n\r\n    public exportCsv (name: string) {\r\n        const headers = [\r\n            '#',\r\n            'Start [min]',\r\n            'End [min]',\r\n            'Retention Time [min]',\r\n            'Maximal Signal [mV]',\r\n            'Response [mV.s]'\r\n        ];\r\n        const rows = this.peaks.map((peak, i) => [\r\n            i + 1,\r\n            peak.start.toFixed(this.decimals),\r\n            peak.end.toFixed(this.decimals),\r\n            (peak.retention.time - peak.start).toFixed(this.decimals),\r\n            peak.retention.signal.toFixed(this.decimals),\r\n            (peak.response * 60).toFixed(this.decimals)\r\n        ]);\r\n\r\n        const csv = headers.join(',') + '\\n' + rows.map((x) => x.join(',')).join('\\n');\r\n        this.download(csv, name);\r\n    }\r\n\r\n    private download (data: string, name: string) {\r\n        const blob = new Blob([data]);\r\n\r\n        const a = document.createElement('a');\r\n        a.href = URL.createObjectURL(blob);\r\n        a.target = '_blank';\r\n        a.download = name;\r\n        a.click();\r\n    }\r\n\r\n    private getPeaks (): IPeak[] {\r\n\r\n        const peaks: IPeak[] = [];\r\n\r\n        let lastMarks: IMark[] = [];\r\n        for (let i = 0; i < this.marks.length; i++) {\r\n            const mark = this.marks[i];\r\n\r\n            if (mark.type === 'start') {\r\n                lastMarks.push(mark);\r\n            } else if (mark.type === 'end' && lastMarks.length > 0) {\r\n\r\n                for (let j = 0; j < lastMarks.length; j++) {\r\n                    peaks.push({\r\n                        start: lastMarks[j].time,\r\n                        end: lastMarks[j + 1] && lastMarks[j + 1].type === 'start' ? lastMarks[j + 1].time : mark.time,\r\n                        previous: j > 0 ? lastMarks[0] : undefined,\r\n                        next: lastMarks[j + 1] && lastMarks[j + 1].type === 'start' ? mark : undefined,\r\n                        values: this.getValues(lastMarks[j], lastMarks[j + 1] && lastMarks[j + 1].type === 'start' ? lastMarks[j + 1] : mark),\r\n                        response: 0,\r\n                        retention: undefined\r\n                    });\r\n                }\r\n\r\n                lastMarks = [];\r\n            }\r\n        }\r\n\r\n        for (const peak of peaks) {\r\n            peak.response = this.getResponse(\r\n                peak.values,\r\n                this.values[peak.previous ? peak.previous.index : undefined],\r\n                this.values[peak.next ? peak.next.index : undefined]\r\n            );\r\n\r\n            peak.retention = peak.values.reduce((p, x) => !p || x.signal > p.signal ? x : p, undefined);\r\n        }\r\n\r\n        return peaks;\r\n    }\r\n\r\n    private getValues (from: IMark, to: IMark): IValue[] {\r\n        return [...this.values.slice(from.index, to.index + 1)];\r\n    }\r\n\r\n    private getResponse (values: IValue[], previous?: IValue, next?: IValue): number {\r\n        const baseFrom: IValue = previous ? { time: previous.time, signal: previous.signal } : { time: values[0].time, signal: values[0].signal };\r\n        const baseTo: IValue = next ? { time: next.time, signal: next.signal } : { time: values[values.length - 1].time, signal: values[values.length - 1].signal };\r\n\r\n        let totalArea = 0;\r\n\r\n        for (let i = 0; i < values.length - 1; i++) {\r\n            const h = values[i + 1].time - values[i].time;\r\n\r\n            const intLeft = this.getIntersection(\r\n                baseFrom, baseTo,\r\n                // values[i],\r\n                { time: values[i].time, signal: this.maxSignal },\r\n                { time: values[i].time, signal: this.minSignal }\r\n            );\r\n\r\n            const intRight = this.getIntersection(\r\n                baseFrom, baseTo,\r\n                // values[i + 1],\r\n                { time: values[i + 1].time, signal: this.maxSignal },\r\n                { time: values[i + 1].time, signal: this.minSignal }\r\n            );\r\n\r\n            const a = values[i].signal - intLeft.signal;\r\n            const b = values[i + 1].signal - intRight.signal;\r\n\r\n            const area = ((a + b) / 2) * h;\r\n            totalArea += Math.abs(area);\r\n        }\r\n\r\n        return totalArea;\r\n    }\r\n\r\n    private getIntersection (l1From: IValue, l1To: IValue, l2From: IValue, l2To: IValue): IValue {\r\n        const p0x = l1From.time;\r\n        const p0y = l1From.signal;\r\n        const p1x = l1To.time;\r\n        const p1y = l1To.signal;\r\n        const p2x = l2From.time;\r\n        const p2y = l2From.signal;\r\n        const p3x = l2To.time;\r\n        const p3y = l2To.signal;\r\n\r\n        const s1x = p1x - p0x;\r\n        const s1y = p1y - p0y;\r\n        const s2x = p3x - p2x;\r\n        const s2y = p3y - p2y;\r\n\r\n        let ix: number;\r\n        let iy: number;\r\n\r\n        const s = (-s1y * (p0x - p2x) + s1x * (p0y - p2y)) / (-s2x * s1y + s1x * s2y);\r\n        const t = (s2x * (p0y - p2y) - s2y * (p0x - p2x)) / (-s2x * s1y + s1x * s2y);\r\n\r\n        if (s >= 0 && s <= 1 && t >= 0 && t <= 1) {\r\n            ix = p0x + (t * s1x);\r\n            iy = p0y + (t * s1y);\r\n            return { time: ix, signal: iy };\r\n        }\r\n\r\n        return null;\r\n    }\r\n}\r\n","import { Chart } from './Chart';\r\nimport { Data } from './Data';\r\nimport { IData } from './interfaces/IData';\r\nimport { IMark } from './interfaces/IMark';\r\nimport { Table } from './Table';\r\n\r\nexport class App {\r\n    private canvas: HTMLCanvasElement;\r\n    private tableWrapper: HTMLDivElement;\r\n    private controlsWrapper: HTMLDivElement;\r\n\r\n    private chart: Chart;\r\n    private table: Table;\r\n\r\n    private data: IData;\r\n    private marks: IMark[] = [];\r\n\r\n    constructor () {\r\n        this.createUI();\r\n\r\n        this.chart = new Chart(this.canvas);\r\n        this.table = new Table(this.tableWrapper);\r\n\r\n        this.chart.onMarksUpdated = (marks) => {\r\n            this.marks = marks;\r\n            this.table.update(this.marks, this.data ? this.data.values : undefined);\r\n        };\r\n\r\n        window.onresize = () => {\r\n            this.resize();\r\n            this.chart.render();\r\n            this.table.update(this.marks, this.data ? this.data.values : undefined);\r\n        };\r\n\r\n        this.resize();\r\n    }\r\n\r\n    private createUI () {\r\n        const template = `\r\n            <canvas id=\"chart\"></canvas>\r\n            <div id=\"table\"></div>\r\n            <div id=\"controls\">\r\n                <button id=\"start\" class=\"selected\">Start</button>\r\n                <button id=\"end\">End</button>\r\n                <button id=\"move\">Move</button>\r\n                <br/><br/>\r\n                <button id=\"export\">Export to CSV</button>\r\n                <br/><br/>\r\n                <input type=\"file\" name=\"datafile\" id=\"datafile\" accept=\"text/plain\" />\r\n                <br/><br/>\r\n                <div class=\"shortcuts\">\r\n                    Shortcuts:<br/>\r\n                    <b>s</b> - Start<br/>\r\n                    <b>e</b> - End<br/>\r\n                    <b>m</b> or hold <b>Ctrl</b> - Move<br/>\r\n                    <b>mouse wheel</b> - Zoom<br/>\r\n                </div>\r\n                <div id=\"version\">Version: 2019-11-13T20:00:00+0100</div>\r\n            </div>\r\n        `;\r\n        document.body.insertAdjacentHTML('afterbegin', template);\r\n\r\n        this.canvas = document.getElementById('chart') as HTMLCanvasElement;\r\n        this.tableWrapper = document.getElementById('table') as HTMLDivElement;\r\n        this.controlsWrapper = document.getElementById('controls') as HTMLDivElement;\r\n\r\n        const start = document.getElementById('start');\r\n        const end = document.getElementById('end');\r\n        const move = document.getElementById('move');\r\n        const exportCsv = document.getElementById('export');\r\n        const input = document.getElementById('datafile') as HTMLInputElement;\r\n\r\n        start.onclick = () => {\r\n            start.classList.add('selected');\r\n            end.classList.remove('selected');\r\n            move.classList.remove('selected');\r\n\r\n            this.chart.setTool('start');\r\n        };\r\n\r\n        end.onclick = () => {\r\n            end.classList.add('selected');\r\n            start.classList.remove('selected');\r\n            move.classList.remove('selected');\r\n\r\n            this.chart.setTool('end');\r\n        };\r\n\r\n        move.onclick = () => {\r\n            move.classList.add('selected');\r\n            start.classList.remove('selected');\r\n            end.classList.remove('selected');\r\n\r\n            this.chart.setTool('move');\r\n        };\r\n\r\n        exportCsv.onclick = () => {\r\n            if (this.data) {\r\n                this.table.exportCsv(this.data.name.replace(/\\.[^.]+$/i, ''));\r\n            }\r\n        };\r\n\r\n        input.onchange = async () => {\r\n            this.data = await this.getData(input.files[0]);\r\n\r\n            if (this.data) {\r\n                this.chart.setData(this.data);\r\n            }\r\n        };\r\n    }\r\n\r\n    private async getData (file: File): Promise<IData> {\r\n        const text = await this.readFile(file);\r\n\r\n        return new Data(file.name, text);\r\n    }\r\n\r\n    private async readFile (file: File): Promise<string> {\r\n        return new Promise<string>((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.readAsText(file);\r\n\r\n            reader.onload = () => {\r\n                resolve(reader.result.toString());\r\n            };\r\n            reader.onerror = (e) => {\r\n                reject(e);\r\n            };\r\n        });\r\n    }\r\n\r\n    private resize () {\r\n        const w = window.innerWidth;\r\n        const h = window.innerHeight;\r\n\r\n        this.canvas.width = w;\r\n        this.canvas.height = Math.floor(h * (2 / 3));\r\n\r\n        this.tableWrapper.style.height = `${h - this.canvas.height + 1}px`;\r\n        this.controlsWrapper.style.height = `${h - this.canvas.height + 1}px`;\r\n    }\r\n}\r\n","import { App } from './App';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        anim: number;\r\n        interval: number;\r\n        timeout: number;\r\n    }\r\n}\r\n\r\n// parcel-bunder: cleanup after auto reload\r\nlet dead = document.body.querySelector('canvas') as HTMLElement;\r\nif (dead) {\r\n    dead.parentNode.removeChild(dead);\r\n}\r\ndead = document.body.querySelector('div') as HTMLElement;\r\nif (dead) {\r\n    dead.parentNode.removeChild(dead);\r\n}\r\n\r\nwindow.cancelAnimationFrame(window.anim);\r\nwindow.clearInterval(window.interval);\r\nwindow.clearTimeout(window.timeout);\r\n\r\nconsole.clear();\r\nconsole.log(new Date());\r\n\r\nnew App();\r\n"]}